# https原理

## SSL协议握手过程
![SSL协议握手过程](https://github.com/everseeker0307/code-library/blob/master/src/blog/static/SSL%E5%8D%8F%E8%AE%AE%E6%8F%A1%E6%89%8B%E8%BF%87%E7%A8%8B.png)

## 如何保证安全  
**密钥**  
1. 正式会话过程，会话内容都是加密过的；如果需要破解，只需要拿到对话密钥即可。  
2. 对话密钥由3个随机数和约定好的加密方法生成；在SSL协议握手阶段，加密方法和前2个随机数都是明文传输，可以直接截获，因此破解的关键在于获取第3个随机数premaster secret。  
3. premaster secret通过CA证书中的公钥RSA算法加密后传输，如果需要破解，需要得到私钥，而私钥存储在server端，在整个握手以及会话过程中都没有传输。
4. RSA算法目前几乎无法破解，或者说破解需要的时间足够长；而对话密钥是每一次对话都重新生成一次的。
**CA证书**  
1. 服务端发送给客户端的数字证书需要到CA机构认证，浏览器默认信任CA机构颁布的证书；因此如果篡改数字证书，客户端浏览器会直接不信任。  
2. 一般来说证书必须由CA颁发。也可以自己建立根证书，然后颁发证书，但是自建的根证书默认浏览器不信任，除非导入到"受信任的根证书"中。  

## 一些基础知识
1. 非对称加密算法：比如RSA算法，存在2个密钥，公钥和私钥。使用公钥加密后，只能使用私钥解密。  
2. 对称加密算法：比如3DES, AES128, AES256, CHACHA20等，只有一个密钥，加密解密使用同一个密钥。  
